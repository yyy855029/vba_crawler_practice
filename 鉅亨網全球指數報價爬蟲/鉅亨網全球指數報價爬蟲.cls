VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "ThisWorkbook"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True

Sub ъxW计厨基()
    Dim i As Integer
    Dim j As Integer
    
    With ThisWorkbook.Worksheets("xW计厨基")
        ' M鸥戤
        .Range("A5:S39").Clear
        .Range("C2").Clear
        
        ' ]w程癃氦u@ら
        If Weekday(Date) = 7 Then
            ' P戳せBz
            .Range("C2") = DateAdd("d", -1, Date)
        ElseIf Weekday(Date) = 1 Then
            ' P戳らBz
            .Range("C2") = DateAdd("d", -2, Date)
        End If
        
        ' qd牒臾歙xW计厨基戈
        ' 栋いカ初
        With .QueryTables.Add(Connection:= _
            "URL;https://www.cnyes.com/twstock/Index2Real_idx.htm", Destination:=.Range( _
            "$A$5"))
            .WebFormatting = xlWebFormattingNone
            .WebTables = "1"
            .WebPreFormattedTextToColumns = True
            .Refresh BackgroundQuery:=False
        End With
        
        ' dRカ初
        With .QueryTables.Add(Connection:= _
            "URL;https://www.cnyes.com/twstock/Index2Real_idx.htm", Destination:=.Range( _
            "$K$5"))
            .WebFormatting = xlWebFormattingNone
            .WebTables = "2"
            .WebPreFormattedTextToColumns = True
            .Refresh BackgroundQuery:=False
        End With
        
        ' MQらΜL基ゑ计鹊郐
        ' 栋いカ初
        For i = 6 To .Range("D6").End(xlDown).Row
            ' ΜL基
            If .Cells(i, 4) > 0 Then
                .Range(.Cells(i, 3), .Cells(i, 5)).Font.ColorIndex = 3
            ElseIf Cells(i, 4) < 0 Then
                .Range(.Cells(i, 3), .Cells(i, 5)).Font.ColorIndex = 10
            End If
            
            ' }LB程蔼B程C基
            For j = 6 To 8
                If .Cells(i, j) > .Cells(i, 9) Then
                    .Cells(i, j).Font.ColorIndex = 3
                ElseIf .Cells(i, j) < .Cells(i, 9) Then
                    .Cells(i, j).Font.ColorIndex = 10
                End If
            Next j
            
        Next i
        
        ' dRカ初
        For i = 6 To .Range("N6").End(xlDown).Row
            ' ΜL基
            If .Cells(i, 14) > 0 Then
                .Range(.Cells(i, 13), .Cells(i, 15)).Font.ColorIndex = 3
            ElseIf Cells(i, 14) < 0 Then
                .Range(.Cells(i, 13), .Cells(i, 15)).Font.ColorIndex = 10
            End If
            
            ' }LB程蔼B程C基
            For j = 16 To 18
                If .Cells(i, j) > .Cells(i, 19) Then
                    .Cells(i, j).Font.ColorIndex = 3
                ElseIf .Cells(i, j) < .Cells(i, 19) Then
                    .Cells(i, j).Font.ColorIndex = 10
                End If
            Next j
        
        Next i
        
    End With
End Sub


Sub ъㄈw计厨基()
    Dim i As Integer
    Dim j As Integer
    
    With ThisWorkbook.Worksheets("ㄈw计厨基")
        ' M鸥戤
        .Range("A5:I21").Clear
        .Range("C2").Clear
        .Range("C2") = Date
        
        ' qd牒臾歙ㄈw计厨基戈
        With .QueryTables.Add(Connection:= _
            "URL;https://www.cnyes.com/global/IndexImmediateQuotedPrice/003/QuotationPrice.aspx" _
            , Destination:=.Range("$A$5"))
            .WebFormatting = xlWebFormattingNone
            .WebPreFormattedTextToColumns = True
            .Refresh BackgroundQuery:=False
        End With
        
        ' MQらΜL基ゑ计鹊郐
        ' 栋いカ初
        For i = 6 To .Range("D6").End(xlDown).Row
            ' ΜL基
            If .Cells(i, 4) > 0 Then
                .Range(.Cells(i, 3), .Cells(i, 5)).Font.ColorIndex = 3
            ElseIf .Cells(i, 4) < 0 Then
                .Range(.Cells(i, 3), .Cells(i, 5)).Font.ColorIndex = 10
            End If
            
            ' }LB程蔼B程C基
            For j = 6 To 8
                If .Cells(i, j) > .Cells(i, 9) Then
                    .Cells(i, j).Font.ColorIndex = 3
                ElseIf .Cells(i, j) < .Cells(i, 9) Then
                    .Cells(i, j).Font.ColorIndex = 10
                End If
            Next j
            
        Next i
    
    End With
End Sub


Sub ъ稼w计厨基()
    Dim i As Integer
    Dim j As Integer
    
    With ThisWorkbook.Worksheets("稼w计厨基")
        ' M鸥戤
        .Range("A5:I22").Clear
        .Range("C2").Clear
        .Range("C2") = Date
        
        ' qd牒臾歙稼w计厨基戈
        With .QueryTables.Add(Connection:= _
            "URL;https://www.cnyes.com/global/IndexImmediateQuotedPrice/004/QuotationPrice.aspx" _
            , Destination:=.Range("$A$5"))
            .WebFormatting = xlWebFormattingNone
            .WebPreFormattedTextToColumns = True
            .Refresh BackgroundQuery:=False
        End With
        
        ' MQらΜL基ゑ计鹊郐
        ' 栋いカ初
        For i = 6 To .Range("D6").End(xlDown).Row
            ' ΜL基
            If .Cells(i, 4) > 0 Then
                .Range(.Cells(i, 3), .Cells(i, 5)).Font.ColorIndex = 3
            ElseIf .Cells(i, 4) < 0 Then
                .Range(.Cells(i, 3), .Cells(i, 5)).Font.ColorIndex = 10
            End If
            
            ' }LB程蔼B程C基
            For j = 6 To 8
                If .Cells(i, j) > .Cells(i, 9) Then
                    .Cells(i, j).Font.ColorIndex = 3
                ElseIf .Cells(i, j) < .Cells(i, 9) Then
                    .Cells(i, j).Font.ColorIndex = 10
                End If
            Next j
            
        Next i
    
    End With
End Sub


Sub ъw计厨基()
    Dim i As Integer
    Dim j As Integer
    
    With ThisWorkbook.Worksheets("w计厨基")
        ' M鸥戤
        .Range("A5:I16").Clear
        .Range("C2").Clear
        .Range("C2") = Date
        
        ' qd牒臾歙w计厨基戈
        With .QueryTables.Add(Connection:= _
            "URL;https://www.cnyes.com/global/IndexImmediateQuotedPrice/005/QuotationPrice.aspx" _
            , Destination:=.Range("$A$5"))
            .WebFormatting = xlWebFormattingNone
            .WebPreFormattedTextToColumns = True
            .Refresh BackgroundQuery:=False
        End With
        
        ' MQらΜL基ゑ计鹊郐
        ' 栋いカ初
        For i = 6 To .Range("D6").End(xlDown).Row
            ' ΜL基
            If .Cells(i, 4) > 0 Then
                .Range(.Cells(i, 3), .Cells(i, 5)).Font.ColorIndex = 3
            ElseIf .Cells(i, 4) < 0 Then
                .Range(.Cells(i, 3), .Cells(i, 5)).Font.ColorIndex = 10
            End If
            
            ' }LB程蔼B程C基
            For j = 6 To 8
                If .Cells(i, j) > .Cells(i, 9) Then
                    .Cells(i, j).Font.ColorIndex = 3
                ElseIf .Cells(i, j) < .Cells(i, 9) Then
                    .Cells(i, j).Font.ColorIndex = 10
                End If
            Next j
            
        Next i
    
    End With
End Sub


Private Sub Workbook_Open()
    Call ъxW计厨基
    Call ъㄈw计厨基
    Call ъ稼w计厨基
    Call ъw计厨基
    ThisWorkbook.Worksheets("xW计厨基").Select
End Sub



